# SyncAI v1.1（GPT-5.1対応）設計一式

---

## 1. 要件定義書（v1.1）

### 目的
- SyncAI において **ChatGPT API は GPT-5.x 系のみを使用**する
- 最優先は **gpt-5.2**、利用不可の場合のみ **gpt-5.1** を使用する
- GPT-5.x が利用不可の場合は **エラーとして終了**し、品質を落として継続しない

### 機能要件
- ChatGPT と Perplexity を並列実行する
- 両方成功時のみ統合回答を生成する
- 片方失敗時は成功側の回答＋通知を返す
- 両方失敗時はエラーを返す

### 非機能要件
- UIは変更しない
- モデル選択はソースコードで管理する
- GPT-4系・mini系は使用しない

---

## 2. 基本設計書（v1.1）

### 全体構成
- UI層：Windsurf 実装済み（変更不可）
- ロジック層：Antigravity が main プロセスで実装
- AI連携：OpenAI API（ChatGPT）、Perplexity API

### モデル利用方針
- ChatGPT モデル優先順：
  1. gpt-5.2
  2. gpt-5.1
- 上記以外は使用禁止

### フロー概要
1. ユーザー入力
2. ChatGPT / Perplexity 並列実行
3. 成功判定
4. 統合 or 単独回答 or エラー返却

---

## 3. 詳細設計書（v1.1）

### ChatGPT 呼び出し仕様
- 使用モデル：gpt-5.2 → gpt-5.1（フォールバック）
- 両方失敗時はエラー終了
- system / user メッセージは既存仕様を踏襲

### フォールバック条件
- モデル未対応
- 権限エラー
- モデル指定起因の 400 / 404 / 429

### 状態管理（変更なし）
- idle
- querying_chatgpt
- querying_perplexity
- integrating
- completed
- error

### UI返却形式（変更なし）
```ts
{ status, finalAnswer?, notices?, error? }
```

### ログ・セキュリティ
- プロンプト・回答本文はログ出力禁止
- 出力可：使用モデル名、成功/失敗、フォールバック有無

---

## 備考
- 本設計は v1.0 からの **後方互換を維持**する
- GPT-5.x 系が一般提供された場合、即座に品質向上が反映される

